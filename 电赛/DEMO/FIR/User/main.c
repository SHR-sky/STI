#include "sys.h"
#include "stdlib.h"

float32_t inbuf[1281] = {0,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,-3.67E-16,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,-1.22E-15,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,-1.10E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,-2.45E-15,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,3.49E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,-3.67E-15,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,8.09E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,-4.90E-15,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,-3.31E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,1.16E-14,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,6.62E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,-7.35E-15,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,5.88E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,2.70E-14,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,5.15E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,-9.80E-15,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,4.41E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,-1.10E-14,0.244157996,0.480700573,0.702300707,0.902197103,1.074449792,1.21416421,1.317675134,1.382683432,1.408340374,1.395276269,1.345572356,1.262677014,1.151269538,1.017076717,0.866649277,0.707106781,0.545860803,0.390327021,0.247637298,0.124362831,0.026258998,-0.041958268,-0.076795987,-0.076120467,-0.039241215,0.033060803,0.138561641,0.273678499,0.433606277,0.612501294,0.803705134,1,1.193885778,1.377868159,1.544746743,1.687892062,1.801500865,1.880819868,1.922329346,1.923879533,1.884774574,1.805800797,1.689198222,1.538576393,1.358777765,1.155693886,0.936041447,0.707106781,0.476468633,0.251709852,0.040129071,-0.151536548,-0.317366868,-0.452482796,-0.553230187,-0.617316568,-0.643895427,-0.633594855,-0.588489432,-0.512016459,-0.408839759,-0.284666292,-0.146022648,3.68E-15,0.146022648,0.284666292,0.408839759,0.512016459,0.588489432,0.633594855,0.643895427,0.617316568,0.553230187,0.452482796,0.317366868,0.151536548,-0.040129071,-0.251709852,-0.476468633,-0.707106781,-0.936041447,-1.155693886,-1.358777765,-1.538576393,-1.689198222,-1.805800797,-1.884774574,-1.923879533,-1.922329346,-1.880819868,-1.801500865,-1.687892062,-1.544746743,-1.377868159,-1.193885778,-1,-0.803705134,-0.612501294,-0.433606277,-0.273678499,-0.138561641,-0.033060803,0.039241215,0.076120467,0.076795987,0.041958268,-0.026258998,-0.124362831,-0.247637298,-0.390327021,-0.545860803,-0.707106781,-0.866649277,-1.017076717,-1.151269538,-1.262677014,-1.345572356,-1.395276269,-1.408340374,-1.382683432,-1.317675134,-1.21416421,-1.074449792,-0.902197103,-0.702300707,-0.480700573,-0.244157996,2.33E-14};
	
float32_t outbuf[1281] = {0.0f};

uint16_t BL = 101;
float32_t B[101] = {
  -0.002364379994766,-0.002555816813742, -0.00271143828077,-0.002821346700614,
  -0.002865814202786,-0.002816683118228,-0.002640000779638,-0.002299699197689,
  -0.001762028066288,-0.001000368319048,4.399291056296e-18, 0.001237622441001,
   0.002691519514449, 0.004319142530531, 0.006055934652271, 0.007816685262717,
   0.009498734985135,  0.01098694698435,  0.01216021777687,  0.01289916830821,
    0.01309454373426,  0.01265576722454,  0.01151904640175, 0.009654425543614,
   0.007071214384679, 0.003821304224151,-5.964020643576e-18,-0.004255853855223,
  -0.008772504883931, -0.01334655058446, -0.01775451146912, -0.02176424083345,
   -0.02514755140538, -0.02769333338392, -0.02922037668388,  -0.0295890978537,
   -0.02871141129903, -0.02655807388539, -0.02316296707884, -0.01862395375005,
   -0.01310014718858, -0.00680564532364,-1.977442795623e-17, 0.007024104515362,
    0.01395531112556,  0.02047939405639,  0.02629552027152,  0.03113204072429,
    0.03476090062898,  0.03700983073789,  0.03777160643401,  0.03700983073789,
    0.03476090062898,  0.03113204072429,  0.02629552027152,  0.02047939405639,
    0.01395531112556, 0.007024104515362,-1.977442795623e-17, -0.00680564532364,
   -0.01310014718858, -0.01862395375005, -0.02316296707884, -0.02655807388539,
   -0.02871141129903,  -0.0295890978537, -0.02922037668388, -0.02769333338392,
   -0.02514755140538, -0.02176424083345, -0.01775451146912, -0.01334655058446,
  -0.008772504883931,-0.004255853855223,-5.964020643576e-18, 0.003821304224151,
   0.007071214384679, 0.009654425543614,  0.01151904640175,  0.01265576722454,
    0.01309454373426,  0.01289916830821,  0.01216021777687,  0.01098694698435,
   0.009498734985135, 0.007816685262717, 0.006055934652271, 0.004319142530531,
   0.002691519514449, 0.001237622441001,4.399291056296e-18,-0.001000368319048,
  -0.001762028066288,-0.002299699197689,-0.002640000779638,-0.002816683118228,
  -0.002865814202786,-0.002821346700614, -0.00271143828077,-0.002555816813742,
  -0.002364379994766
};

uint32_t blockSize = 1281;
float pState[1381] = {0.0f};



int main()
{
	Serial_Init();
	arm_fir_instance_f32 *S;
	
	S = (arm_fir_instance_f32 *)malloc(sizeof(arm_fir_instance_f32));
	if(S==NULL)
	{
		return 0;
	}
	arm_fir_init_f32(S,BL,B,pState,blockSize);
	arm_fir_f32(S,inbuf,outbuf,blockSize);
	
	float data[4];
	for(int i=0; i<1281; i++)
	{
		data[0] = outbuf[i];
		Serial_Printf("%f\n",outbuf[i]);
		//JustFloat_Send(data, 0);
		delay_ms(1);
	}
	
	free(S);
	S = NULL;
}




